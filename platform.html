<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>×¤×œ×˜×¤×•×¨××ª ×©×™×ª×•×£ ×ª×›× ×™× ×œ××—×•× × ×™×</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            /* Light theme */
            --bg-primary: #f8fafc;
            --bg-secondary: #ffffff;
            --bg-tertiary: #f1f5f9;
            --text-primary: #1e293b;
            --text-secondary: #64748b;
            --accent-primary: #3b82f6;
            --accent-hover: #2563eb;
            --border-color: #e2e8f0;
            --shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1);
            --gradient: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            --success: #10b981;
            --warning: #f59e0b;
            --error: #ef4444;
            --gold: #fbbf24;
            --upload-btn: #059669;
            --upload-btn-hover: #047857;
        }

        [data-theme="dark"] {
            /* Dark theme */
            --bg-primary: #0f172a;
            --bg-secondary: #1e293b;
            --bg-tertiary: #334155;
            --text-primary: #f1f5f9;
            --text-secondary: #94a3b8;
            --accent-primary: #60a5fa;
            --accent-hover: #3b82f6;
            --border-color: #334155;
            --shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.3);
            --gradient: linear-gradient(135deg, #1e3a8a 0%, #3730a3 100%);
            --success: #059669;
            --warning: #d97706;
            --error: #dc2626;
            --gold: #f59e0b;
            --upload-btn: #059669;
            --upload-btn-hover: #047857;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: var(--bg-primary);
            color: var(--text-primary);
            transition: all 0.3s ease;
            min-height: 100vh;
        }

        /* Header */
        .header {
            background: var(--bg-secondary);
            padding: 1rem 2rem;
            border-bottom: 2px solid var(--border-color);
            box-shadow: var(--shadow);
            position: sticky;
            top: 0;
            z-index: 1000;
        }

        .header-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
            max-width: 1400px;
            margin: 0 auto;
        }

        .logo-section {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .logo-img {
            width: 50px;
            height: 50px;
            border-radius: 8px;
        }

        .logo-text h1 {
            font-size: 1.8rem;
            font-weight: 700;
            background: var(--gradient);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .logo-text p {
            color: var(--text-secondary);
            font-size: 1rem;
            font-weight: 500;
        }

        .header-actions {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .upload-btn {
            background: var(--upload-btn);
            color: white;
            border: none;
            padding: 0.8rem 1.5rem;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1rem;
            font-weight: 600;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .upload-btn:hover {
            background: var(--upload-btn-hover);
            transform: translateY(-2px);
        }

        .user-section {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .theme-toggle {
            background: var(--bg-tertiary);
            border: 2px solid var(--border-color);
            border-radius: 50%;
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .theme-toggle:hover {
            border-color: var(--accent-primary);
            transform: scale(1.1);
        }

        .user-info {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            background: var(--bg-tertiary);
            padding: 0.5rem 1rem;
            border-radius: 25px;
            border: 1px solid var(--border-color);
        }

        .user-avatar {
            width: 32px;
            height: 32px;
            border-radius: 50%;
            background: var(--gradient);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: 600;
        }

        .logout-btn {
            background: var(--error);
            color: white;
            border: none;
            padding: 0.5rem 1rem;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .logout-btn:hover {
            background: #dc2626;
            transform: translateY(-2px);
        }

        /* Main Content */
        .main-content {
            max-width: 1400px;
            margin: 0 auto;
            padding: 2rem;
        }

        .welcome-section {
            text-align: center;
            margin-bottom: 3rem;
        }

        .welcome-title {
            font-size: 2.2rem;
            font-weight: 700;
            margin-bottom: 1rem;
            background: var(--gradient);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .welcome-subtitle {
            font-size: 1.2rem;
            color: var(--text-secondary);
            margin-bottom: 1rem;
            line-height: 1.6;
        }

        /* Search Section */
        .search-section {
            margin-bottom: 3rem;
        }

        .search-title {
            font-size: 1.8rem;
            font-weight: 600;
            margin-bottom: 1rem;
            text-align: center;
        }

        .search-container {
            position: relative;
            max-width: 800px;
            margin: 0 auto;
        }

        .search-input {
            width: 100%;
            padding: 1.2rem 3rem 1.2rem 1.5rem;
            border: 2px solid var(--border-color);
            border-radius: 50px;
            background: var(--bg-secondary);
            color: var(--text-primary);
            font-size: 1.1rem;
            transition: all 0.3s ease;
        }

        .search-input:focus {
            outline: none;
            border-color: var(--accent-primary);
            box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
        }

        .search-input::placeholder {
            color: var(--text-secondary);
        }

        .search-icon {
            position: absolute;
            left: 1.5rem;
            top: 50%;
            transform: translateY(-50%);
            color: var(--text-secondary);
            font-size: 1.2rem;
        }

        .search-suggestions {
            text-align: center;
            margin-top: 1rem;
            color: var(--text-secondary);
            font-style: italic;
        }

        /* Search Results */
        .search-results {
            display: none;
            margin-top: 2rem;
        }

        .search-results.active {
            display: block;
        }

        .results-table {
            width: 100%;
            border-collapse: collapse;
            background: var(--bg-secondary);
            border-radius: 12px;
            overflow: hidden;
            box-shadow: var(--shadow);
        }

        .results-table th,
        .results-table td {
            padding: 1rem;
            text-align: right;
            border-bottom: 1px solid var(--border-color);
        }

        .results-table th {
            background: var(--bg-tertiary);
            font-weight: 600;
            color: var(--text-secondary);
        }

        .result-row {
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .result-row:hover {
            background: var(--bg-tertiary);
        }

        .result-title {
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 0.5rem;
        }

        .result-description {
            color: var(--text-secondary);
            font-size: 0.9rem;
            line-height: 1.4;
        }

        .result-meta {
            display: flex;
            gap: 1rem;
            color: var(--text-secondary);
            font-size: 0.9rem;
        }

        /* Categories Section */
        .categories-section {
            margin-bottom: 3rem;
        }

        .categories-title {
            font-size: 1.8rem;
            font-weight: 600;
            margin-bottom: 2rem;
            text-align: center;
        }

        .categories-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 1.5rem;
        }

        /* FIFA-style category cards */
        .category-card {
            position: relative;
            background: linear-gradient(145deg, #2d5aa0, #1e3a72);
            border-radius: 15px;
            padding: 1.5rem;
            cursor: pointer;
            transition: all 0.3s ease;
            border: 2px solid transparent;
            overflow: hidden;
            min-height: 180px;
            display: flex;
            flex-direction: column;
            justify-content: space-between;
        }

        .category-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 60%;
            background: linear-gradient(145deg, rgba(255,255,255,0.1), rgba(255,255,255,0.05));
            border-radius: 15px 15px 0 0;
        }

        .category-card:hover {
            transform: translateY(-8px) scale(1.02);
            box-shadow: 0 25px 40px rgba(0, 0, 0, 0.3);
            border-color: var(--gold);
        }

        /* Different colors for categories */
        .category-card:nth-child(1) { background: linear-gradient(145deg, #ff6b6b, #ee5a52); }
        .category-card:nth-child(2) { background: linear-gradient(145deg, #4ecdc4, #44a08d); }
        .category-card:nth-child(3) { background: linear-gradient(145deg, #45b7d1, #3a9bc1); }
        .category-card:nth-child(4) { background: linear-gradient(145deg, #f9ca24, #f0932b); }
        .category-card:nth-child(5) { background: linear-gradient(145deg, #a55eea, #8b4db8); }
        .category-card:nth-child(6) { background: linear-gradient(145deg, #26de81, #20bf6b); }
        .category-card:nth-child(7) { background: linear-gradient(145deg, #fd79a8, #e84393); }
        .category-card:nth-child(8) { background: linear-gradient(145deg, #fdcb6e, #e17055); }
        .category-card:nth-child(9) { background: linear-gradient(145deg, #6c5ce7, #5f3dc4); }
        .category-card:nth-child(10) { background: linear-gradient(145deg, #00b894, #00a085); }
        .category-card:nth-child(11) { background: linear-gradient(145deg, #636e72, #2d3436); }

        .category-icon {
            font-size: 3rem;
            text-align: center;
            margin-bottom: 1rem;
            color: white;
            text-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);
            z-index: 2;
            position: relative;
        }

        .category-name {
            color: white;
            font-weight: 700;
            font-size: 1.1rem;
            text-align: center;
            line-height: 1.3;
            text-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);
            z-index: 2;
            position: relative;
        }

        .category-count {
            color: rgba(255, 255, 255, 0.8);
            font-size: 0.9rem;
            text-align: center;
            margin-top: 0.5rem;
            z-index: 2;
            position: relative;
        }

        /* Content Section */
        .content-section {
            display: none;
        }

        .content-section.active {
            display: block;
        }

        .back-btn {
            background: var(--bg-tertiary);
            border: 2px solid var(--border-color);
            color: var(--text-primary);
            padding: 0.8rem 1.5rem;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1rem;
            font-weight: 600;
            transition: all 0.3s ease;
            margin-bottom: 2rem;
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
        }

        .back-btn:hover {
            background: var(--border-color);
            transform: translateY(-2px);
        }

        .content-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 2rem;
        }

        .content-title {
            font-size: 1.8rem;
            font-weight: 600;
        }

        /* View Toggle */
        .view-toggle {
            display: flex;
            justify-content: center;
            gap: 0.5rem;
            margin-bottom: 1rem;
        }

        .view-btn {
            padding: 0.5rem 1rem;
            border: 2px solid var(--border-color);
            background: var(--bg-secondary);
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .view-btn.active {
            background: var(--accent-primary);
            color: white;
            border-color: var(--accent-primary);
        }

        /* Sort buttons */
        .sort-section {
            display: flex;
            justify-content: center;
            gap: 0.5rem;
            margin-bottom: 2rem;
            flex-wrap: wrap;
        }

        .sort-btn {
            padding: 0.5rem 1rem;
            border: 2px solid var(--border-color);
            background: var(--bg-secondary);
            color: var(--text-primary);
            border-radius: 25px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 0.9rem;
        }

        .sort-btn.active, .sort-btn:hover {
            background: var(--accent-primary);
            color: white;
            border-color: var(--accent-primary);
        }

        /* Content Grid */
        .content-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 1.5rem;
            margin-top: 2rem;
        }

        .content-card {
            background: var(--bg-secondary);
            border-radius: 12px;
            padding: 1.5rem;
            box-shadow: var(--shadow);
            border: 1px solid var(--border-color);
            transition: all 0.3s ease;
            cursor: pointer;
            position: relative;
        }

        .content-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1);
        }

        .content-card-title {
            font-size: 1.2rem;
            font-weight: 600;
            margin-bottom: 1rem;
            line-height: 1.3;
        }

        .content-meta {
            display: flex;
            flex-wrap: wrap;
            gap: 1rem;
            margin-bottom: 1rem;
            font-size: 0.9rem;
            color: var(--text-secondary);
        }

        .content-rating {
            display: flex;
            align-items: center;
            gap: 0.3rem;
        }

        .stars {
            color: var(--gold);
        }

        .delete-btn {
            position: absolute;
            top: 10px;
            left: 10px;
            background: var(--error);
            color: white;
            border: none;
            border-radius: 50%;
            width: 25px;
            height: 25px;
            cursor: pointer;
            font-size: 0.8rem;
            display: none;
        }

        .content-card:hover .delete-btn {
            display: block;
        }

        .content-tags {
            display: flex;
            flex-wrap: wrap;
            gap: 0.5rem;
            margin-top: 1rem;
        }

        .content-tag {
            background: var(--bg-tertiary);
            color: var(--text-secondary);
            padding: 0.2rem 0.6rem;
            border-radius: 12px;
            font-size: 0.8rem;
        }

        /* List View - Fixed styling */
        .content-grid.list-view {
            display: block;
        }

        .content-grid.list-view .content-card {
            display: grid;
            grid-template-columns: 1fr auto;
            grid-template-areas: 
                "title actions"
                "meta meta"
                "description description"
                "tags tags";
            gap: 0.5rem 1rem;
            margin-bottom: 1rem;
            padding: 1.5rem;
            align-items: start;
        }

        .content-grid.list-view .content-card-title {
            grid-area: title;
            margin-bottom: 0;
            font-size: 1.1rem;
        }

        .content-grid.list-view .content-meta {
            grid-area: meta;
            margin-bottom: 0;
            display: flex;
            flex-wrap: wrap;
            gap: 1rem;
            font-size: 0.85rem;
        }

        .content-grid.list-view .content-description {
            grid-area: description;
            margin: 0.5rem 0;
        }

        .content-grid.list-view .content-tags {
            grid-area: tags;
            margin-top: 0.5rem;
        }

        .content-grid.list-view .delete-btn {
            grid-area: actions;
            position: relative;
            top: auto;
            left: auto;
            display: block;
            opacity: 0.7;
        }

        .content-grid.list-view .content-card:hover .delete-btn {
            opacity: 1;
        }

        /* Empty State */
        .empty-state {
            text-align: center;
            padding: 3rem;
            color: var(--text-secondary);
        }

        /* Modal Styles */
        .modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.7);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 2000;
            padding: 1rem;
        }

        .modal.active {
            display: flex;
        }

        .modal-content {
            background: var(--bg-secondary);
            padding: 2rem;
            border-radius: 16px;
            box-shadow: var(--shadow);
            border: 1px solid var(--border-color);
            max-width: 600px;
            width: 100%;
            max-height: 90vh;
            overflow-y: auto;
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 2rem;
            border-bottom: 1px solid var(--border-color);
            padding-bottom: 1rem;
        }

        .modal-title {
            font-size: 1.5rem;
            font-weight: 600;
        }

        .modal-close {
            background: none;
            border: none;
            font-size: 1.5rem;
            cursor: pointer;
            color: var(--text-secondary);
            padding: 0.5rem;
        }

        .modal-close:hover {
            color: var(--text-primary);
        }

        /* Form Styles */
        .form-group {
            margin-bottom: 1.5rem;
        }

        .form-label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: 600;
            color: var(--text-primary);
        }

        .form-input,
        .form-select,
        .form-textarea {
            width: 100%;
            padding: 0.8rem;
            border: 2px solid var(--border-color);
            border-radius: 8px;
            background: var(--bg-primary);
            color: var(--text-primary);
            font-size: 1rem;
            transition: all 0.3s ease;
            font-family: inherit;
        }

        .form-input:focus,
        .form-select:focus,
        .form-textarea:focus {
            outline: none;
            border-color: var(--accent-primary);
            box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
        }

        .form-textarea {
            resize: vertical;
            min-height: 100px;
        }

        .form-input:disabled,
        .form-select:disabled {
            background: var(--bg-tertiary);
            color: var(--text-secondary);
            cursor: not-allowed;
        }

        .tags-input {
            position: relative;
        }

        .tags-container {
            min-height: 40px;
            border: 2px solid var(--border-color);
            border-radius: 8px;
            padding: 0.5rem;
            background: var(--bg-primary);
            display: flex;
            flex-wrap: wrap;
            gap: 0.5rem;
            cursor: text;
        }

        .tags-container.focused {
            border-color: var(--accent-primary);
            box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
        }

        .tag {
            background: var(--accent-primary);
            color: white;
            padding: 0.3rem 0.8rem;
            border-radius: 20px;
            font-size: 0.9rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .tag-remove {
            background: none;
            border: none;
            color: white;
            cursor: pointer;
            font-size: 1rem;
        }

        .tags-input-field {
            border: none;
            outline: none;
            background: transparent;
            color: var(--text-primary);
            flex: 1;
            min-width: 120px;
            padding: 0.3rem;
        }

        .file-upload {
            position: relative;
            display: inline-block;
            width: 100%;
        }

        .file-upload-input {
            display: none;
        }

        .file-upload-label {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 1rem;
            padding: 2rem;
            border: 2px dashed var(--border-color);
            border-radius: 8px;
            background: var(--bg-primary);
            cursor: pointer;
            transition: all 0.3s ease;
            color: var(--text-secondary);
        }

        .file-upload-label:hover {
            border-color: var(--accent-primary);
            background: rgba(59, 130, 246, 0.05);
        }

        .file-upload-label.has-file {
            border-color: var(--success);
            background: rgba(16, 185, 129, 0.05);
            color: var(--success);
        }

        .btn {
            padding: 0.8rem 1.5rem;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1rem;
            font-weight: 600;
            transition: all 0.3s ease;
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
        }

        .btn-primary {
            background: var(--accent-primary);
            color: white;
        }

        .btn-primary:hover {
            background: var(--accent-hover);
            transform: translateY(-2px);
        }

        .btn-success {
            background: var(--success);
            color: white;
        }

        .btn-success:hover {
            background: #059669;
            transform: translateY(-2px);
        }

        .btn-secondary {
            background: var(--bg-tertiary);
            color: var(--text-primary);
            border: 2px solid var(--border-color);
        }

        .btn-secondary:hover {
            background: var(--border-color);
        }

        .btn-danger {
            background: var(--error);
            color: white;
        }

        .btn-danger:hover {
            background: #dc2626;
        }

        /* Loading */
        .loading {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 2px solid var(--border-color);
            border-top: 2px solid var(--accent-primary);
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* Rating Stars */
        .rating-input {
            display: flex;
            gap: 0.2rem;
            margin: 1rem 0;
        }

        .rating-star {
            font-size: 1.5rem;
            color: var(--border-color);
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .rating-star:hover,
        .rating-star.active {
            color: var(--gold);
        }

        /* Comments */
        .comments-section {
            margin-top: 2rem;
            border-top: 1px solid var(--border-color);
            padding-top: 2rem;
        }

        .comment {
            background: var(--bg-tertiary);
            padding: 1rem;
            border-radius: 8px;
            margin-bottom: 1rem;
        }

        .comment-author {
            font-weight: 600;
            margin-bottom: 0.5rem;
        }

        .comment-content {
            line-height: 1.5;
            margin-bottom: 0.5rem;
        }

        .comment-date {
            font-size: 0.8rem;
            color: var(--text-secondary);
        }

        /* Responsive */
        @media (max-width: 768px) {
            .header-content {
                flex-direction: column;
                gap: 1rem;
                align-items: stretch;
            }

            .header-actions {
                justify-content: center;
            }

            .main-content {
                padding: 1rem;
            }

            .categories-grid {
                grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            }

            .modal-content {
                margin: 1rem;
                padding: 1.5rem;
            }

            .results-table {
                font-size: 0.9rem;
            }

            .results-table th,
            .results-table td {
                padding: 0.8rem;
            }

            .content-grid.list-view .content-card {
                grid-template-columns: 1fr;
                grid-template-areas: 
                    "title"
                    "meta"
                    "description"
                    "tags"
                    "actions";
            }

            .content-grid.list-view .delete-btn {
                grid-area: actions;
                position: relative;
                top: auto;
                left: auto;
                margin-top: 1rem;
            }
        }

        /* Animation */
        .fade-in {
            animation: fadeIn 0.6s ease-out;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        /* Hidden sections */
        .home-section {
            display: block;
        }

        .home-section.hidden {
            display: none;
        }

        .categories-section.hidden {
            display: none;
        }

        /* Tags input focus styles */
        .tags-container:focus-within {
            border-color: var(--accent-primary);
            box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
        }

        /* Search input animation */
        .search-input:focus::placeholder {
            opacity: 0.3;
            transform: translateX(10px);
            transition: all 0.3s ease;
        }

        /* Category hover effects */
        .category-card::after {
            content: '';
            position: absolute;
            top: -2px;
            left: -2px;
            right: -2px;
            bottom: -2px;
            background: linear-gradient(45deg, transparent, rgba(255,255,255,0.1), transparent);
            border-radius: 17px;
            z-index: -1;
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .category-card:hover::after {
            opacity: 1;
        }
    </style>
</head>
<body>
    <!-- Header -->
    <header class="header">
        <div class="header-content">
            <div class="logo-section">
                <img src="https://i.ibb.co/JjK9HTcm/gifted.png" alt="×œ×•×’×• ××—×•× × ×™×" class="logo-img">
                <div class="logo-text">
                    <h1>×—×•××¨ ×¤×ª×•×— - ××—×•× × ×™×</h1>
                    <p id="userRole">×˜×•×¢×Ÿ...</p>
                </div>
            </div>
            <div class="header-actions">
                <button class="upload-btn" id="uploadBtn">
                    <span>â•</span>
                    ×”×¢×œ×• ×ª×•×›×Ÿ
                </button>
            </div>
            <div class="user-section">
                <button class="theme-toggle" id="themeToggle">
                    <span id="themeIcon">ğŸŒ™</span>
                </button>
                <div class="user-info">
                    <div class="user-avatar" id="userAvatar">ğŸ‘¤</div>
                    <span id="userName">×˜×•×¢×Ÿ...</span>
                </div>
                <button class="logout-btn" id="logoutBtn">×™×¦×™××”</button>
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <main class="main-content">
        <!-- Home Section -->
        <section class="home-section" id="homeSection">
            <!-- Welcome Section -->
            <div class="welcome-section fade-in">
                <h2 class="welcome-title" id="welcomeTitle">×©×œ×•× [×©× ×”××©×ª××©], ×‘×¨×•×š ×”×‘× ×œ×¤×œ×˜×¤×•×¨××” ×œ×©×™×ª×•×£ ×ª×›× ×™× ×œ××—×•× × ×™×</h2>
                <div class="welcome-subtitle">
                    ×›××Ÿ ×ª×•×›×œ×• ×œ××¦×•× ×‘×§×œ×•×ª ×ª×›× ×™× ××•×ª×××™× ×œ×”×•×¨××ª ××—×•× × ×™×, ×œ×”×¢×œ×•×ª ×ª×›× ×™× ×‘××•×¤×Ÿ ×¤×©×•×˜ ×•× ×¢×™×, ×œ×©×ª×£, ×œ×”×’×™×‘, ×œ×“×¨×’ ×•×œ×¢×•×“×“ ×™×¦×™×¨×ª ×§×”×™×œ×” ××§×¦×•×¢×™×ª ×¤×¢×™×œ×”
                </div>
            </div>

            <!-- Search Section -->
            <div class="search-section">
                <h3 class="search-title">×—×¤×©×• ×ª×•×›×Ÿ</h3>
                <div class="search-container">
                    <input type="text" class="search-input" id="searchInput" placeholder="×—×¤×©×• ×œ×¤×™ ×©× ×¤×¢×™×œ×•×ª, ×ª×’×™×•×ª ××• ×ª×™××•×¨...">
                    <div class="search-icon">ğŸ”</div>
                </div>
                <div class="search-suggestions">
                    ×× ×™××¦×™×”, ×ª×œ×ª ××™××“, ×”×¡×¨×ª ×¨×§×¢, ×× ×”×™×’×•×ª, ×›×œ×™ AI ×•×¢×•×“...
                </div>
            </div>

            <!-- Search Results -->
            <div class="search-results" id="searchResults">
                <h3 style="margin-bottom: 1rem;">×ª×•×¦××•×ª ×—×™×¤×•×©</h3>
                <table class="results-table" id="resultsTable">
                    <thead>
                        <tr>
                            <th>×¤×¢×™×œ×•×ª</th>
                            <th>×“×™×¨×•×’</th>
                            <th>×ª×’×•×‘×•×ª</th>
                            <th>××¢×œ×”</th>
                            <th>×§×˜×’×•×¨×™×”</th>
                            <th>×ª××¨×™×š</th>
                        </tr>
                    </thead>
                    <tbody id="resultsTableBody">
                        <!-- Search results will appear here -->
                    </tbody>
                </table>
            </div>

            <!-- Categories Section -->
            <div class="categories-section" id="categoriesSection">
                <h3 class="categories-title">×”×§×˜×’×•×¨×™×•×ª</h3>
                <div class="categories-grid">
                    <div class="category-card" data-category="quick-ideas">
                        <div class="category-icon">âš¡</div>
                        <div class="category-name">×¨×¢×™×•× ×•×ª ×–×¨×™×–×™× ×©×œ 5 ×“×§×•×ª</div>
                        <div class="category-count" data-count="0">0 ×¤×¢×™×œ×•×™×•×ª</div>
                    </div>
                    <div class="category-card" data-category="lesson-plans">
                        <div class="category-icon">ğŸ“š</div>
                        <div class="category-name">××¢×¨×›×™ ×©×™×¢×•×¨ ××•×ª×××™× ×œ××—×•× × ×™× - ×”×›×•×œ×œ×™× ×—×§×¨ ×•××ª×’×¨</div>
                        <div class="category-count" data-count="0">0 ×¤×¢×™×œ×•×™×•×ª</div>
                    </div>
                    <div class="category-card" data-category="full-courses">
                        <div class="category-icon">ğŸ¯</div>
                        <div class="category-name">×¨×¢×™×•× ×•×ª ×œ×§×•×¨×¡×™× ×©×œ××™×, ×¡×™×œ×‘×•×¡×™×, ×›×™×•×•× ×™× ×œ×§×•×¨×¡×™×</div>
                        <div class="category-count" data-count="0">0 ×¤×¢×™×œ×•×™×•×ª</div>
                    </div>
                    <div class="category-card" data-category="open-development">
                        <div class="category-icon">ğŸ”§</div>
                        <div class="category-name">×¨×¢×™×•× ×•×ª ×¤×ª×•×—×™× ×œ×¤×™×ª×•×—</div>
                        <div class="category-count" data-count="0">0 ×¤×¢×™×œ×•×™×•×ª</div>
                    </div>
                    <div class="category-card" data-category="group-challenges">
                        <div class="category-icon">ğŸ‘¥</div>
                        <div class="category-name">××ª×’×¨×™× ×§×‘×•×¦×ª×™×™×</div>
                        <div class="category-count" data-count="0">0 ×¤×¢×™×œ×•×™×•×ª</div>
                    </div>
                    <div class="category-card" data-category="ai-tools">
                        <div class="category-icon">ğŸ¤–</div>
                        <div class="category-name">×›×œ×™ AI ××• ××¤×œ×™×§×¦×™×•×ª ×©×™×›×•×œ×•×ª ×œ×”×¨×™× ×©×™×¢×•×¨</div>
                        <div class="category-count" data-count="0">0 ×¤×¢×™×œ×•×™×•×ª</div>
                    </div>
                    <div class="category-card" data-category="independent-learning">
                        <div class="category-icon">ğŸ“</div>
                        <div class="category-name">××©×™××•×ª ×”××¢×•×“×“×•×ª ×œ××™×“×” ×¢×¦×××™×ª</div>
                        <div class="category-count" data-count="0">0 ×¤×¢×™×œ×•×™×•×ª</div>
                    </div>
                    <div class="category-card" data-category="games-activities">
                        <div class="category-icon">ğŸ®</div>
                        <div class="category-name">××©×—×§×™ ×—×‘×¨×”, ×”×¤×¡×§×•×ª ×¤×¢×™×œ×•×ª, ×¨×¢×™×•× ×•×ª ×œ×™××™× ××™×•×—×“×™× ×•×œ×™××™ ×©×™×</div>
                        <div class="category-count" data-count="0">0 ×¤×¢×™×œ×•×™×•×ª</div>
                    </div>
                    <div class="category-card" data-category="counseling">
                        <div class="category-icon">ğŸ’­</div>
                        <div class="category-name">×¤×¢×™×œ×•×™×•×ª ××”×¤×Ÿ ×”×™×™×¢×•×¦×™ ×”×—×™× ×•×›×™: ×ª×§×©×•×¨×ª, ×›×™×©×•×¨×™ ×—×™×™×, ×× ×”×™×’×•×ª</div>
                        <div class="category-count" data-count="0">0 ×¤×¢×™×œ×•×™×•×ª</div>
                    </div>
                    <div class="category-card" data-category="teacher-sharing">
                        <div class="category-icon">ğŸ‘©â€ğŸ«</div>
                        <div class="category-name">××•×¨×™× ××©×ª×¤×™× ××” ×¢×‘×“ ×œ×”×</div>
                        <div class="category-count" data-count="0">0 ×¤×¢×™×œ×•×™×•×ª</div>
                    </div>
                    <div class="category-card" data-category="other">
                        <div class="category-icon">ğŸ“</div>
                        <div class="category-name">×¤×¢×™×œ×•×™×•×ª ××—×¨×•×ª</div>
                        <div class="category-count" data-count="0">0 ×¤×¢×™×œ×•×™×•×ª</div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Content Section -->
        <section class="content-section" id="contentSection">
            <button class="back-btn" id="backBtn">
                <span>â†</span>
                ×—×–×¨×” ×œ×¢××•×“ ×”×¨××©×™
            </button>
            
            <div class="content-header">
                <h2 class="content-title" id="contentTitle">×§×˜×’×•×¨×™×”</h2>
                <button class="upload-btn" id="categoryUploadBtn">
                    <span>â•</span>
                    ×”×•×¡×£ ×ª×•×›×Ÿ ×œ×§×˜×’×•×¨×™×”
                </button>
            </div>

            <div class="view-toggle">
                <button class="view-btn active" data-view="grid">×ª×¦×•×’×ª ×›×¨×˜×™×¡×™×</button>
                <button class="view-btn" data-view="list">×ª×¦×•×’×ª ×¨×©×™××”</button>
            </div>

            <div class="sort-section">
                <button class="sort-btn active" data-sort="recent">×—×“×©×™×</button>
                <button class="sort-btn" data-sort="rating">×“×™×¨×•×’ ×’×‘×•×”</button>
                <button class="sort-btn" data-sort="comments">×ª×’×•×‘×•×ª ×¨×‘×•×ª</button>
                <button class="sort-btn" data-sort="popular">×¤×•×¤×•×œ×¨×™×•×ª</button>
            </div>

            <div class="content-grid" id="contentGrid">
                <!-- Content will be loaded here -->
            </div>

            <div class="empty-state" id="emptyState" style="display: none;">
                <div style="font-size: 3rem; margin-bottom: 1rem;">ğŸ“š</div>
                <h3>××™×Ÿ ×ª×›× ×™× ×‘×§×˜×’×•×¨×™×” ×–×• ×¢×“×™×™×Ÿ</h3>
                <p>×”×™×” ×”×¨××©×•×Ÿ ×œ×”×¢×œ×•×ª ×ª×•×›×Ÿ ×‘×§×˜×’×•×¨×™×” ×–×•!</p>
            </div>
        </section>
    </main>

    <!-- Upload Modal -->
    <div class="modal" id="uploadModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title">×”×¢×œ××ª ×ª×•×›×Ÿ ×—×“×©</h2>
                <button class="modal-close" id="closeUploadModal">&times;</button>
            </div>
            <form id="uploadForm">
                <div class="form-group">
                    <label class="form-label">×©× ×”×¤×¢×™×œ×•×ª *</label>
                    <input type="text" class="form-input" id="activityName" required>
                </div>

                <div class="form-group">
                    <label class="form-label">×ª×™××•×¨ ×‘×§×¦×¨×” ×©×œ ×”×¤×¢×™×œ×•×ª *</label>
                    <textarea class="form-textarea" id="activityDescription" required placeholder="×ª××¨×• ×‘×§×¦×¨×” ××ª ×”×¤×¢×™×œ×•×ª, ××˜×¨×ª×” ×•×›×™×¦×“ ×”×™× ××ª××™××” ×œ××—×•× × ×™×"></textarea>
                </div>

                <div class="form-group">
                    <label class="form-label">×©× ×”××¢×œ×” *</label>
                    <input type="text" class="form-input" id="uploaderName" readonly>
                </div>

                <div class="form-group">
                    <label class="form-label">××™×•×¢×“ ×œ×§×˜×’×•×¨×™×” *</label>
                    <select class="form-select" id="categorySelect" required>
                        <option value="">×‘×—×¨ ×§×˜×’×•×¨×™×”</option>
                        <option value="quick-ideas">×¨×¢×™×•× ×•×ª ×–×¨×™×–×™× ×©×œ 5 ×“×§×•×ª</option>
                        <option value="lesson-plans">××¢×¨×›×™ ×©×™×¢×•×¨ ××•×ª×××™× ×œ××—×•× × ×™×</option>
                        <option value="full-courses">×¨×¢×™×•× ×•×ª ×œ×§×•×¨×¡×™× ×©×œ××™×</option>
                        <option value="open-development">×¨×¢×™×•× ×•×ª ×¤×ª×•×—×™× ×œ×¤×™×ª×•×—</option>
                        <option value="group-challenges">××ª×’×¨×™× ×§×‘×•×¦×ª×™×™×</option>
                        <option value="ai-tools">×›×œ×™ AI ××• ××¤×œ×™×§×¦×™×•×ª</option>
                        <option value="independent-learning">××©×™××•×ª ×œ××™×“×” ×¢×¦×××™×ª</option>
                        <option value="games-activities">××©×—×§×™ ×—×‘×¨×” ×•×¤×¢×™×œ×•×™×•×ª</option>
                        <option value="counseling">×¤×¢×™×œ×•×™×•×ª ×™×™×¢×•×¦×™×•×ª ×—×™× ×•×›×™×•×ª</option>
                        <option value="teacher-sharing">××•×¨×™× ××©×ª×¤×™×</option>
                        <option value="other">×¤×¢×™×œ×•×™×•×ª ××—×¨×•×ª</option>
                    </select>
                </div>

                <div class="form-group">
                    <label class="form-label">×’×™×œ ××•××œ×¥ *</label>
                    <select class="form-select" id="ageGroup" required>
                        <option value="">×‘×—×¨ ×’×™×œ ××•××œ×¥</option>
                        <option value="elementary">×™×¡×•×“×™</option>
                        <option value="middle">×—×˜×™×‘×ª ×‘×™× ×™×™×</option>
                        <option value="high">×ª×™×›×•×Ÿ</option>
                        <option value="all">×›×œ ×”×’×™×œ××™×</option>
                    </select>
                </div>

                <div class="form-group">
                    <label class="form-label">×ª×’×™×•×ª ×œ×—×™×¤×•×©</label>
                    <div class="tags-input">
                        <div class="tags-container" id="tagsContainer">
                            <input type="text" class="tags-input-field" id="tagsInput" placeholder="×”×§×œ×™×“×• ×ª×’×™×ª ×•×œ×—×¦×• ×¢×œ ×¤×¡×™×§ ××• Enter">
                        </div>
                    </div>
                    <small style="color: var(--text-secondary); font-size: 0.8rem;">×”×§×œ×™×“×• ×ª×’×™×ª ×•×œ×—×¦×• ×¢×œ ×¤×¡×™×§ ××• Enter ×œ×”×•×¡×¤×”</small>
                </div>

                <div class="form-group">
                    <label class="form-label">×”×¢×œ××ª ×§×•×‘×¥ *</label>
                    <div class="file-upload">
                        <input type="file" class="file-upload-input" id="fileInput" accept=".pdf,.docx,.pptx,.jpg,.jpeg,.png" required>
                        <label for="fileInput" class="file-upload-label" id="fileLabel">
                            <span style="font-size: 2rem;">ğŸ“</span>
                            <div>
                                <div>×œ×—×¦×• ×œ×‘×—×™×¨×ª ×§×•×‘×¥</div>
                                <div style="font-size: 0.8rem; margin-top: 0.5rem;">PDF, DOCX, PPTX, JPG, PNG</div>
                            </div>
                        </label>
                    </div>
                </div>

                <div style="display: flex; gap: 1rem; justify-content: flex-end; margin-top: 2rem;">
                    <button type="button" class="btn btn-secondary" id="cancelUploadBtn">×‘×™×˜×•×œ</button>
                    <button type="submit" class="btn btn-primary" id="submitUploadBtn">
                        <span>×”×¢×œ×• ××ª ×”×¤×¢×™×œ×•×ª</span>
                        <div class="loading" style="display: none;"></div>
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- Content Details Modal -->
    <div class="modal" id="contentModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title" id="contentModalTitle">×¤×¨×˜×™ ×ª×•×›×Ÿ</h2>
                <button class="modal-close" id="closeContentModal">&times;</button>
            </div>
            <div id="contentModalBody">
                <!-- Content details will be loaded here -->
            </div>
        </div>
    </div>

    <!-- Firebase Scripts -->
    <script type="module">
        // Import Firebase modules
        import { initializeApp } from "https://www.gstatic.com/firebasejs/12.1.0/firebase-app.js";
        import { getAuth, onAuthStateChanged, signOut } from "https://www.gstatic.com/firebasejs/12.1.0/firebase-auth.js";
        import { getDatabase, ref, set, get, push, onValue, query, orderByChild, remove } from "https://www.gstatic.com/firebasejs/12.1.0/firebase-database.js";
        import { getStorage, ref as storageRef, uploadBytes, getDownloadURL, deleteObject } from "https://www.gstatic.com/firebasejs/12.1.0/firebase-storage.js";
        import firebaseConfig from './config.js';

        // Initialize Firebase
        const app = initializeApp(firebaseConfig);
        const auth = getAuth(app);
        const database = getDatabase(app);
        const storage = getStorage(app);

        // Global variables
        let currentUser = null;
        let userData = null;
        let userRole = null;
        let currentCategory = null;
        let currentView = 'grid';
        let currentSort = 'recent';
        let allContent = [];
        let currentTags = [];

        // Categories mapping
        const categoriesInfo = {
            'quick-ideas': { name: '×¨×¢×™×•× ×•×ª ×–×¨×™×–×™× ×©×œ 5 ×“×§×•×ª', icon: 'âš¡' },
            'lesson-plans': { name: '××¢×¨×›×™ ×©×™×¢×•×¨ ××•×ª×××™× ×œ××—×•× × ×™×', icon: 'ğŸ“š' },
            'full-courses': { name: '×¨×¢×™×•× ×•×ª ×œ×§×•×¨×¡×™× ×©×œ××™×', icon: 'ğŸ¯' },
            'open-development': { name: '×¨×¢×™×•× ×•×ª ×¤×ª×•×—×™× ×œ×¤×™×ª×•×—', icon: 'ğŸ”§' },
            'group-challenges': { name: '××ª×’×¨×™× ×§×‘×•×¦×ª×™×™×', icon: 'ğŸ‘¥' },
            'ai-tools': { name: '×›×œ×™ AI ××• ××¤×œ×™×§×¦×™×•×ª', icon: 'ğŸ¤–' },
            'independent-learning': { name: '××©×™××•×ª ×œ××™×“×” ×¢×¦×××™×ª', icon: 'ğŸ“' },
            'games-activities': { name: '××©×—×§×™ ×—×‘×¨×” ×•×¤×¢×™×œ×•×™×•×ª', icon: 'ğŸ®' },
            'counseling': { name: '×¤×¢×™×œ×•×™×•×ª ×™×™×¢×•×¦×™×•×ª ×—×™× ×•×›×™×•×ª', icon: 'ğŸ’­' },
            'teacher-sharing': { name: '××•×¨×™× ××©×ª×¤×™×', icon: 'ğŸ‘©â€ğŸ«' },
            'other': { name: '×¤×¢×™×œ×•×™×•×ª ××—×¨×•×ª', icon: 'ğŸ“' }
        };

        // DOM Elements
        const themeToggle = document.getElementById('themeToggle');
        const themeIcon = document.getElementById('themeIcon');
        const logoutBtn = document.getElementById('logoutBtn');
        const userName = document.getElementById('userName');
        const userAvatar = document.getElementById('userAvatar');
        const userRoleElement = document.getElementById('userRole');
        const welcomeTitle = document.getElementById('welcomeTitle');
        const uploadBtn = document.getElementById('uploadBtn');
        const categoryUploadBtn = document.getElementById('categoryUploadBtn');
        const backBtn = document.getElementById('backBtn');
        const searchInput = document.getElementById('searchInput');
        
        // Sections
        const homeSection = document.getElementById('homeSection');
        const contentSection = document.getElementById('contentSection');
        const categoriesSection = document.getElementById('categoriesSection');
        const searchResults = document.getElementById('searchResults');
        
        // Modals
        const uploadModal = document.getElementById('uploadModal');
        const contentModal = document.getElementById('contentModal');

        // Initialize app
        function initApp() {
            initTheme();
            setupEventListeners();
            checkAuthState();
        }

        // Auth state management
        function checkAuthState() {
            onAuthStateChanged(auth, async (user) => {
                if (user) {
                    currentUser = user;
                    await loadUserData();
                    setupUI();
                    loadAllContent();
                    updateCategoryCounts();
                } else {
                    window.location.href = 'index.html';
                }
            });
        }

        async function loadUserData() {
            try {
                const userRef = ref(database, `users/${currentUser.uid}`);
                const snapshot = await get(userRef);
                
                if (snapshot.exists()) {
                    userData = snapshot.val();
                    userRole = userData.role;
                    
                    // Update UI
                    userName.textContent = userData.name;
                    userAvatar.textContent = userData.name.charAt(0);
                    userRoleElement.textContent = userRole === 'admin' ? '×× ×”×œ ××¢×¨×›×ª' : '××•×¨×”';
                    
                    const firstName = userData.name.split(' ')[0];
                    welcomeTitle.textContent = `×©×œ×•× ${firstName}, ×‘×¨×•×š ×”×‘× ×œ×¤×œ×˜×¤×•×¨××” ×œ×©×™×ª×•×£ ×ª×›× ×™× ×œ××—×•× × ×™×`;
                    
                    // Set uploader name in form
                    document.getElementById('uploaderName').value = userData.name;
                } else {
                    console.error('User data not found');
                    await signOut(auth);
                }
            } catch (error) {
                console.error('Error loading user data:', error);
            }
        }

        function setupUI() {
            // Show category upload button for all users (teachers and admins)
            categoryUploadBtn.style.display = 'flex';
        }

        // Theme management
        function initTheme() {
            const savedTheme = localStorage.getItem('theme') || 'light';
            document.documentElement.setAttribute('data-theme', savedTheme);
            updateThemeIcon(savedTheme);
        }

        function updateThemeIcon(theme) {
            themeIcon.textContent = theme === 'dark' ? 'â˜€ï¸' : 'ğŸŒ™';
        }

        function toggleTheme() {
            const currentTheme = document.documentElement.getAttribute('data-theme');
            const newTheme = currentTheme === 'dark' ? 'light' : 'dark';
            
            document.documentElement.setAttribute('data-theme', newTheme);
            localStorage.setItem('theme', newTheme);
            updateThemeIcon(newTheme);
        }// Event listeners
        function setupEventListeners() {
            themeToggle.addEventListener('click', toggleTheme);
            logoutBtn.addEventListener('click', handleLogout);
            uploadBtn.addEventListener('click', openUploadModal);
            categoryUploadBtn.addEventListener('click', openCategoryUploadModal);
            backBtn.addEventListener('click', showHomeSection);

            // Modal events
            document.getElementById('closeUploadModal').addEventListener('click', closeUploadModal);
            document.getElementById('closeContentModal').addEventListener('click', closeContentModal);
            document.getElementById('cancelUploadBtn').addEventListener('click', closeUploadModal);

            // Form events
            document.getElementById('uploadForm').addEventListener('submit', handleUpload);
            document.getElementById('fileInput').addEventListener('change', handleFileSelect);
            document.getElementById('tagsInput').addEventListener('keydown', handleTagInput);

            // Search functionality
            searchInput.addEventListener('input', handleSearch);

            // Category cards
            document.querySelectorAll('.category-card').forEach(card => {
                card.addEventListener('click', () => {
                    const category = card.dataset.category;
                    showCategoryContent(category);
                });
            });

            // View toggle
            document.querySelectorAll('.view-btn').forEach(btn => {
                btn.addEventListener('click', (e) => {
                    document.querySelectorAll('.view-btn').forEach(b => b.classList.remove('active'));
                    e.target.classList.add('active');
                    currentView = e.target.dataset.view;
                    toggleView();
                });
            });

            // Sort buttons
            document.querySelectorAll('[data-sort]').forEach(btn => {
                btn.addEventListener('click', (e) => {
                    document.querySelectorAll('[data-sort]').forEach(b => b.classList.remove('active'));
                    e.target.classList.add('active');
                    currentSort = e.target.dataset.sort;
                    sortAndDisplayContent();
                });
            });

            // Close modals on outside click
            window.addEventListener('click', (e) => {
                if (e.target === uploadModal) closeUploadModal();
                if (e.target === contentModal) closeContentModal();
            });
        }

        // Search functionality
        function handleSearch(e) {
            const searchTerm = e.target.value.toLowerCase().trim();
            
            if (searchTerm === '') {
                // Hide search results, show categories
                searchResults.classList.remove('active');
                categoriesSection.style.display = 'block';
                return;
            }
            
            // Filter content based on search term
            const filteredContent = allContent.filter(item => {
                return item.name.toLowerCase().includes(searchTerm) ||
                       item.description.toLowerCase().includes(searchTerm) ||
                       (item.tags || []).some(tag => tag.toLowerCase().includes(searchTerm));
            });
            
            // Hide categories, show search results
            categoriesSection.style.display = 'none';
            searchResults.classList.add('active');
            
            displaySearchResults(filteredContent);
        }

        function displaySearchResults(results) {
            const tbody = document.getElementById('resultsTableBody');
            
            if (results.length === 0) {
                tbody.innerHTML = `
                    <tr>
                        <td colspan="6" style="text-align: center; padding: 2rem; color: var(--text-secondary);">
                            ×œ× × ××¦××• ×ª×•×¦××•×ª ×—×™×¤×•×©
                        </td>
                    </tr>
                `;
                return;
            }
            
            tbody.innerHTML = results.map(item => {
                const rating = calculateAverageRating(item.ratings || {});
                const ratingsCount = Object.keys(item.ratings || {}).length;
                const commentsCount = Object.keys(item.comments || {}).length;
                const uploadDate = new Date(item.uploadDate).toLocaleDateString('he-IL');
                
                return `
                    <tr class="result-row" data-content-id="${item.id}">
                        <td>
                            <div class="result-title">${item.name}</div>
                            <div class="result-description">${item.description.length > 80 ? item.description.substring(0, 80) + '...' : item.description}</div>
                        </td>
                        <td>
                            <div class="content-rating">
                                <div class="stars">${generateStars(rating)}</div>
                                <span>(${ratingsCount})</span>
                            </div>
                        </td>
                        <td>${commentsCount}</td>
                        <td>${item.uploaderName}</td>
                        <td>${categoriesInfo[item.category].name}</td>
                        <td>${uploadDate}</td>
                    </tr>
                `;
            }).join('');
            
            // Add click handlers for search results
            document.querySelectorAll('.result-row').forEach(row => {
                row.addEventListener('click', () => {
                    const contentId = row.dataset.contentId;
                    openContentModal(contentId);
                });
            });
        }

        // Navigation functions
        function showHomeSection() {
            homeSection.style.display = 'block';
            contentSection.classList.remove('active');
            categoriesSection.style.display = 'block';
            searchResults.classList.remove('active');
            searchInput.value = '';
            currentCategory = null;
        }

        function showCategoryContent(category) {
            currentCategory = category;
            homeSection.style.display = 'none';
            contentSection.classList.add('active');
            
            document.getElementById('contentTitle').textContent = categoriesInfo[category].name;
            
            displayCategoryContent(category);
        }

        // Content loading and display
        async function loadAllContent() {
            try {
                const contentRef = ref(database, 'content');
                onValue(contentRef, (snapshot) => {
                    allContent = [];
                    if (snapshot.exists()) {
                        const data = snapshot.val();
                        Object.keys(data).forEach(key => {
                            allContent.push({
                                id: key,
                                ...data[key]
                            });
                        });
                    }
                    
                    // Update category counts
                    updateCategoryCounts();
                    
                    // If viewing a category, refresh the display
                    if (currentCategory) {
                        displayCategoryContent(currentCategory);
                    }
                });
            } catch (error) {
                console.error('Error loading content:', error);
            }
        }

        function updateCategoryCounts() {
            Object.keys(categoriesInfo).forEach(categoryKey => {
                const count = allContent.filter(item => item.category === categoryKey).length;
                const countElement = document.querySelector(`[data-category="${categoryKey}"] .category-count`);
                if (countElement) {
                    countElement.textContent = `${count} ×¤×¢×™×œ×•×™×•×ª`;
                }
            });
        }

        function displayCategoryContent(category) {
            const categoryContent = allContent.filter(item => item.category === category);
            const contentGrid = document.getElementById('contentGrid');
            const emptyState = document.getElementById('emptyState');
            
            if (categoryContent.length === 0) {
                contentGrid.innerHTML = '';
                emptyState.style.display = 'block';
                return;
            }
            
            emptyState.style.display = 'none';
            renderContent(categoryContent);
        }

        function renderContent(content) {
            const contentGrid = document.getElementById('contentGrid');
            
            const sortedContent = sortContent(content);
            
            contentGrid.innerHTML = sortedContent.map(item => createContentCard(item)).join('');
            
            // Add event listeners to content cards
            document.querySelectorAll('.content-card').forEach(card => {
                card.addEventListener('click', (e) => {
                    if (!e.target.classList.contains('delete-btn')) {
                        const contentId = card.dataset.contentId;
                        openContentModal(contentId);
                    }
                });
            });

            // Add delete button event listeners for admins
            if (userRole === 'admin') {
                document.querySelectorAll('.delete-btn').forEach(btn => {
                    btn.addEventListener('click', (e) => {
                        e.stopPropagation();
                        const contentId = btn.dataset.contentId;
                        deleteContent(contentId);
                    });
                });
            }
        }

        function createContentCard(item) {
            const rating = calculateAverageRating(item.ratings || {});
            const ratingsCount = Object.keys(item.ratings || {}).length;
            const commentsCount = Object.keys(item.comments || {}).length;
            const uploadDate = new Date(item.uploadDate).toLocaleDateString('he-IL');
            
            return `
                <div class="content-card" data-content-id="${item.id}">
                    ${userRole === 'admin' ? `<button class="delete-btn" data-content-id="${item.id}">Ã—</button>` : ''}
                    <div class="content-card-title">${item.name}</div>
                    <div class="content-meta">
                        <div class="content-rating">
                            <div class="stars">${generateStars(rating)}</div>
                            <span>(${ratingsCount})</span>
                        </div>
                        <div>ğŸ’¬ ${commentsCount}</div>
                        <div>ğŸ‘¤ ${item.uploaderName}</div>
                        <div>ğŸ“… ${uploadDate}</div>
                        <div>ğŸ¯ ${getAgeGroupText(item.ageGroup)}</div>
                    </div>
                    <div class="content-description" style="color: var(--text-secondary); font-size: 0.9rem; line-height: 1.4; margin-bottom: 1rem;">
                        ${item.description.length > 100 ? item.description.substring(0, 100) + '...' : item.description}
                    </div>
                    <div class="content-tags">
                        ${(item.tags || []).map(tag => `<span class="content-tag">#${tag}</span>`).join('')}
                    </div>
                </div>
            `;
        }

        function generateStars(rating) {
            const fullStars = Math.floor(rating);
            const halfStar = rating % 1 >= 0.5;
            const emptyStars = 5 - fullStars - (halfStar ? 1 : 0);
            
            return 'â˜…'.repeat(fullStars) + (halfStar ? 'â˜†' : '') + 'â˜†'.repeat(emptyStars);
        }

        function calculateAverageRating(ratings) {
            const values = Object.values(ratings);
            if (values.length === 0) return 0;
            return values.reduce((sum, rating) => sum + rating, 0) / values.length;
        }

        function getAgeGroupText(ageGroup) {
            const ageGroups = {
                'elementary': '×™×¡×•×“×™',
                'middle': '×—×˜×™×‘×”',
                'high': '×ª×™×›×•×Ÿ',
                'all': '×›×œ ×”×’×™×œ××™×'
            };
            return ageGroups[ageGroup] || '×œ× ×¦×•×™×Ÿ';
        }

        function sortContent(content) {
            const sortedContent = [...content];
            
            switch (currentSort) {
                case 'rating':
                    return sortedContent.sort((a, b) => {
                        const aRating = calculateAverageRating(a.ratings || {});
                        const bRating = calculateAverageRating(b.ratings || {});
                        return bRating - aRating;
                    });
                case 'comments':
                    return sortedContent.sort((a, b) => {
                        const aComments = Object.keys(a.comments || {}).length;
                        const bComments = Object.keys(b.comments || {}).length;
                        return bComments - aComments;
                    });
                case 'popular':
                    return sortedContent.sort((a, b) => {
                        const aScore = calculateAverageRating(a.ratings || {}) + Object.keys(a.comments || {}).length * 0.1;
                        const bScore = calculateAverageRating(b.ratings || {}) + Object.keys(b.comments || {}).length * 0.1;
                        return bScore - aScore;
                    });
                case 'recent':
                default:
                    return sortedContent.sort((a, b) => new Date(b.uploadDate) - new Date(a.uploadDate));
            }
        }

        function sortAndDisplayContent() {
            if (currentCategory) {
                displayCategoryContent(currentCategory);
            }
        }

        function toggleView() {
            const contentGrid = document.getElementById('contentGrid');
            if (currentView === 'list') {
                contentGrid.classList.add('list-view');
            } else {
                contentGrid.classList.remove('list-view');
            }
        }

        // Upload functionality
        function openUploadModal() {
            uploadModal.classList.add('active');
            
            // Reset form
            document.getElementById('uploadForm').reset();
            document.getElementById('uploaderName').value = userData.name;
            document.getElementById('categorySelect').disabled = false; // Enable category selection
            currentTags = [];
            updateTagsDisplay();
            resetFileLabel();
        }

        function openCategoryUploadModal() {
            uploadModal.classList.add('active');
            
            // Reset form
            document.getElementById('uploadForm').reset();
            document.getElementById('uploaderName').value = userData.name;
            
            // Lock category selection to current category
            const categorySelect = document.getElementById('categorySelect');
            categorySelect.value = currentCategory;
            categorySelect.disabled = true; // Disable changing category
            
            currentTags = [];
            updateTagsDisplay();
            resetFileLabel();
        }

        function closeUploadModal() {
            uploadModal.classList.remove('active');
            // Re-enable category select when closing modal
            document.getElementById('categorySelect').disabled = false;
        }

        function handleFileSelect(e) {
            const file = e.target.files[0];
            const label = document.getElementById('fileLabel');
            
            if (file) {
                label.classList.add('has-file');
                label.innerHTML = `
                    <span style="font-size: 2rem;">âœ…</span>
                    <div>
                        <div>${file.name}</div>
                        <div style="font-size: 0.8rem; margin-top: 0.5rem;">×§×•×‘×¥ × ×‘×—×¨ ×‘×”×¦×œ×—×”</div>
                    </div>
                `;
            }
        }

        function resetFileLabel() {
            const label = document.getElementById('fileLabel');
            label.classList.remove('has-file');
            label.innerHTML = `
                <span style="font-size: 2rem;">ğŸ“</span>
                <div>
                    <div>×œ×—×¦×• ×œ×‘×—×™×¨×ª ×§×•×‘×¥</div>
                    <div style="font-size: 0.8rem; margin-top: 0.5rem;">PDF, DOCX, PPTX, JPG, PNG</div>
                </div>
            `;
        }

        function handleTagInput(e) {
            if (e.key === ',' || e.key === 'Enter') {
                e.preventDefault();
                const tag = e.target.value.trim();
                if (tag && !currentTags.includes(tag)) {
                    currentTags.push(tag);
                    updateTagsDisplay();
                    e.target.value = '';
                }
            }
        }

        function updateTagsDisplay() {
            const container = document.getElementById('tagsContainer');
            const input = document.getElementById('tagsInput');
            
            // Remove existing tags
            container.querySelectorAll('.tag').forEach(tag => tag.remove());
            
            // Add current tags
            currentTags.forEach(tag => {
                const tagElement = document.createElement('div');
                tagElement.className = 'tag';
                tagElement.innerHTML = `
                    #${tag}
                    <button type="button" class="tag-remove" data-tag="${tag}">Ã—</button>
                `;
                container.insertBefore(tagElement, input);
            });
            
            // Add event listeners for remove buttons
            container.querySelectorAll('.tag-remove').forEach(btn => {
                btn.addEventListener('click', (e) => {
                    const tagToRemove = e.target.dataset.tag;
                    currentTags = currentTags.filter(tag => tag !== tagToRemove);
                    updateTagsDisplay();
                });
            });
        }

        async function handleUpload(e) {
            e.preventDefault();
            
            const submitBtn = document.getElementById('submitUploadBtn');
            const btnText = submitBtn.querySelector('span');
            const loading = submitBtn.querySelector('.loading');
            
            // Show loading
            btnText.style.display = 'none';
            loading.style.display = 'block';
            submitBtn.disabled = true;
            
            try {
                const formData = {
                    name: document.getElementById('activityName').value,
                    description: document.getElementById('activityDescription').value,
                    uploaderName: document.getElementById('uploaderName').value,
                    uploaderEmail: currentUser.email,
                    uploaderUid: currentUser.uid,
                    category: document.getElementById('categorySelect').value,
                    ageGroup: document.getElementById('ageGroup').value,
                    tags: currentTags,
                    uploadDate: new Date().toISOString()
                };
                
                const file = document.getElementById('fileInput').files[0];
                if (!file) {
                    throw new Error('×™×© ×œ×‘×—×•×¨ ×§×•×‘×¥');
                }
                
                // Upload file to Firebase Storage
                const fileRef = storageRef(storage, `content/${Date.now()}_${file.name}`);
                const fileSnapshot = await uploadBytes(fileRef, file);
                const fileURL = await getDownloadURL(fileSnapshot.ref);
                
                formData.fileURL = fileURL;
                formData.fileName = file.name;
                formData.fileType = file.type;
                
                // Save to database
                const contentRef = ref(database, 'content');
                await push(contentRef, formData);
                
                alert('×”×ª×•×›×Ÿ ×”×•×¢×œ×” ×‘×”×¦×œ×—×”!');
                closeUploadModal();
                
            } catch (error) {
                console.error('Error uploading content:', error);
                alert('×©×’×™××” ×‘×”×¢×œ××ª ×”×ª×•×›×Ÿ: ' + error.message);
            } finally {
                // Hide loading
                btnText.style.display = 'block';
                loading.style.display = 'none';
                submitBtn.disabled = false;
            }
        }

        // Content modal functionality
        async function openContentModal(contentId) {
            const content = allContent.find(item => item.id === contentId);
            if (!content) return;
            
            const modalTitle = document.getElementById('contentModalTitle');
            const modalBody = document.getElementById('contentModalBody');
            
            modalTitle.textContent = content.name;
            
            const rating = calculateAverageRating(content.ratings || {});
            const ratingsCount = Object.keys(content.ratings || {}).length;
            const comments = content.comments || {};
            const userRating = content.ratings ? content.ratings[currentUser.uid] : 0;
            
            modalBody.innerHTML = `
                <div style="margin-bottom: 2rem;">
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1rem;">
                        <h3>${content.name}</h3>
                        <a href="${content.fileURL}" download="${content.fileName}" class="btn btn-primary">
                            ğŸ“¥ ×”×•×¨×“ ×§×•×‘×¥
                        </a>
                    </div>
                    
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1rem; margin-bottom: 1rem; color: var(--text-secondary);">
                        <div><strong>××¢×œ×”:</strong> ${content.uploaderName}</div>
                        <div><strong>×ª××¨×™×š ×”×¢×œ××”:</strong> ${new Date(content.uploadDate).toLocaleDateString('he-IL')}</div>
                        <div><strong>×’×™×œ ××•××œ×¥:</strong> ${getAgeGroupText(content.ageGroup)}</div>
                        <div><strong>×§×˜×’×•×¨×™×”:</strong> ${categoriesInfo[content.category].name}</div>
                    </div>
                    
                    <div style="margin-bottom: 2rem;">
                        <strong>×ª×™××•×¨:</strong>
                        <p style="margin-top: 0.5rem; line-height: 1.5;">${content.description}</p>
                    </div>
                    
                    ${content.tags && content.tags.length > 0 ? `
                        <div style="margin-bottom: 2rem;">
                            <strong>×ª×’×™×•×ª:</strong>
                            <div style="display: flex; flex-wrap: wrap; gap: 0.5rem; margin-top: 0.5rem;">
                                ${content.tags.map(tag => `<span class="content-tag">#${tag}</span>`).join('')}
                            </div>
                        </div>
                    ` : ''}
                    
                    <div style="background: var(--bg-tertiary); padding: 1.5rem; border-radius: 8px; margin-bottom: 2rem;">
                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1rem;">
                            <h4>×“×™×¨×•×’ ×”×¤×¢×™×œ×•×ª</h4>
                            <div style="display: flex; align-items: center; gap: 0.5rem;">
                                <div class="stars" style="font-size: 1.2rem;">${generateStars(rating)}</div>
                                <span>(${ratingsCount} ×“×™×¨×•×’×™×)</span>
                            </div>
                        </div>
                        
                        <div>
                            <strong>×“×¨×’×• ××ª ×”×¤×¢×™×œ×•×ª:</strong>
                            <div class="rating-input" id="ratingInput">
                                ${[1,2,3,4,5].map(i => `
                                    <span class="rating-star ${userRating >= i ? 'active' : ''}" data-rating="${i}">â˜…</span>
                                `).join('')}
                            </div>
                        </div>
                    </div>
                    
                    <div class="comments-section">
                        <h4 style="margin-bottom: 1rem;">×ª×’×•×‘×•×ª (${Object.keys(comments).length})</h4>
                        
                        <div style="margin-bottom: 1.5rem;">
                            <textarea id="newComment" placeholder="×›×ª×‘×• ×ª×’×•×‘×”..." 
                                style="width: 100%; padding: 0.8rem; border: 2px solid var(--border-color); border-radius: 8px; background: var(--bg-primary); color: var(--text-primary); min-height: 80px; resize: vertical;"></textarea>
                            <button class="btn btn-primary" style="margin-top: 0.5rem;" onclick="addComment('${contentId}')">
                                ×”×•×¡×£ ×ª×’×•×‘×”
                            </button>
                        </div>
                        
                        <div id="commentsList">
                            ${Object.entries(comments).sort((a, b) => new Date(b[1].date) - new Date(a[1].date)).map(([commentId, comment]) => `
                                <div class="comment">
                                    <div class="comment-author">${comment.authorName}</div>
                                    <div class="comment-content">${comment.text}</div>
                                    <div class="comment-date">${new Date(comment.date).toLocaleDateString('he-IL')} ${new Date(comment.date).toLocaleTimeString('he-IL', {hour: '2-digit', minute: '2-digit'})}</div>
                                </div>
                            `).join('') || '<p style="color: var(--text-secondary);">××™×Ÿ ×ª×’×•×‘×•×ª ×¢×“×™×™×Ÿ. ×”×™×• ×”×¨××©×•× ×™× ×œ×”×’×™×‘!</p>'}
                        </div>
                    </div>
                `;
                
            contentModal.classList.add('active');
            
            // Add rating functionality
            document.querySelectorAll('.rating-star').forEach(star => {
                star.addEventListener('click', (e) => {
                    const rating = parseInt(e.target.dataset.rating);
                    rateContent(contentId, rating);
                });
                
                star.addEventListener('mouseover', (e) => {
                    const rating = parseInt(e.target.dataset.rating);
                    updateStarHover(rating);
                });
                
                star.addEventListener('mouseleave', () => {
                    updateStarHover(userRating);
                });
            });
        }

        function updateStarHover(rating) {
            document.querySelectorAll('.rating-star').forEach((star, index) => {
                if (index < rating) {
                    star.classList.add('active');
                } else {
                    star.classList.remove('active');
                }
            });
        }

        async function rateContent(contentId, rating) {
            try {
                const ratingRef = ref(database, `content/${contentId}/ratings/${currentUser.uid}`);
                await set(ratingRef, rating);
                
                // Refresh modal content
                setTimeout(() => openContentModal(contentId), 500);
            } catch (error) {
                console.error('Error rating content:', error);
                alert('×©×’×™××” ×‘×“×™×¨×•×’ ×”×ª×•×›×Ÿ');
            }
        }

        async function addComment(contentId) {
            const commentText = document.getElementById('newComment').value.trim();
            if (!commentText) {
                alert('×™×© ×œ×›×ª×•×‘ ×ª×’×•×‘×”');
                return;
            }
            
            try {
                const commentsRef = ref(database, `content/${contentId}/comments`);
                await push(commentsRef, {
                    text: commentText,
                    authorName: userData.name,
                    authorUid: currentUser.uid,
                    date: new Date().toISOString()
                });
                
                document.getElementById('newComment').value = '';
                
                // Refresh modal content
                setTimeout(() => openContentModal(contentId), 500);
            } catch (error) {
                console.error('Error adding comment:', error);
                alert('×©×’×™××” ×‘×”×•×¡×¤×ª ×ª×’×•×‘×”');
            }
        }

        function closeContentModal() {
            contentModal.classList.remove('active');
        }

        // Delete content (admin only)
        async function deleteContent(contentId) {
            if (userRole !== 'admin') return;
            
            if (!confirm('×”×× ××ª×” ×‘×˜×•×— ×©×‘×¨×¦×•× ×š ×œ××—×•×§ ××ª ×”×ª×•×›×Ÿ ×”×–×”? ×¤×¢×•×œ×” ×–×• ×œ× × ×™×ª× ×ª ×œ×‘×™×˜×•×œ.')) {
                return;
            }
            
            try {
                const content = allContent.find(item => item.id === contentId);
                if (!content) return;
                
                // Delete file from storage
                if (content.fileURL) {
                    const fileRef = storageRef(storage, content.fileURL);
                    try {
                        await deleteObject(fileRef);
                    } catch (error) {
                        console.log('File already deleted or not found');
                    }
                }
                
                // Delete from database
                const contentRef = ref(database, `content/${contentId}`);
                await remove(contentRef);
                
                alert('×”×ª×•×›×Ÿ × ××—×§ ×‘×”×¦×œ×—×”');
                
            } catch (error) {
                console.error('Error deleting content:', error);
                alert('×©×’×™××” ×‘××—×™×§×ª ×”×ª×•×›×Ÿ');
            }
        }

        // Logout functionality
        async function handleLogout() {
            if (confirm('×”×× ××ª×” ×‘×˜×•×— ×©×‘×¨×¦×•× ×š ×œ×”×ª× ×ª×§?')) {
                try {
                    await signOut(auth);
                    window.location.href = 'index.html';
                } catch (error) {
                    console.error('Error signing out:', error);
                }
            }
        }

        // Make functions globally available
        window.addComment = addComment;
        window.deleteContent = deleteContent;

        // Initialize the app
        initApp();

    </script>
</body>
</html>